class Solution {
public:
    int equalPairs(vector<vector<int>>& grid) {
        int sz = grid.size();
       vector< multiset<int> >cms(sz);

        for(int j=0; j<sz; j++)
        {
            for(int i=0; i<sz; i++){
                cms[j].insert(grid[i][j]);
            }
        }

        multiset<int>rms;
        int cnt=0, k=0;

        for(int i=0; i<sz; i++){
            for(int j=0; j<sz; j++){
                rms.insert(grid[i][j]);
            }

            int elm=0;
            for( auto rit=rms.begin(), cit=cms[k].begin(); rit!=rms.end(); ++rit,++cit ){

                if(*rit == *cit){
                    elm++;

                    if(elm==sz){
                        cnt++;
                    }
                }
                else{
                    break;
                }
            }
            
            k++;
            rms.clear();
        }
        
        return cnt;
    }
};
